<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Pênalti com Goleiro Pulando</title>
<style>
body{
    margin:0;
    background:#1e1e1e;
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
}
canvas{
    background:#2e8b57;
    border:4px solid white;
}
</style>
</head>
<body>

<canvas id="game" width="800" height="500"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let ball = {
    x: 400,
    y: 420,
    radius: 12,
    vx: 0,
    vy: 0,
    moving: false
};

let goalkeeper = {
    baseX: 350,
    x: 350,
    y: 90,
    width: 100,
    height: 20,
    jumping: false,
    jumpProgress: 0,
    targetSide: 0 // -1 esquerda | 1 direita
};

let score = 0;
let attempts = 0;

// ===== CONTROLE DO CHUTE =====
canvas.addEventListener("mousedown", (e) => {
    if(ball.moving) return;

    const rect = canvas.getBoundingClientRect();
    const targetX = e.clientX - rect.left;
    const targetY = e.clientY - rect.top;

    let dx = targetX - ball.x;
    let dy = targetY - ball.y;
    let length = Math.sqrt(dx*dx + dy*dy);

    ball.vx = (dx/length) * 8;
    ball.vy = (dy/length) * 8;
    ball.moving = true;

    // Decide lado do pulo
    goalkeeper.targetSide = targetX < 400 ? -1 : 1;
    goalkeeper.jumping = true;
    goalkeeper.jumpProgress = 0;
});

// ===== DESENHO =====
function drawField(){
    ctx.fillStyle = "#2e8b57";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    ctx.strokeStyle = "white";
    ctx.lineWidth = 4;
    ctx.strokeRect(250,50,300,100);
}

function drawBall(){
    ctx.beginPath();
    ctx.fillStyle = "white";
    ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI*2);
    ctx.fill();
}

function drawGoalkeeper(){
    ctx.fillStyle = "blue";
    ctx.fillRect(goalkeeper.x, goalkeeper.y, goalkeeper.width, goalkeeper.height);
}

function drawScore(){
    ctx.fillStyle = "white";
    ctx.font = "20px Arial";
    ctx.fillText("Gols: " + score, 20, 30);
    ctx.fillText("Tentativas: " + attempts, 20, 55);
}

// ===== LÓGICA =====
function update(){

    // Movimento da bola
    if(ball.moving){
        ball.x += ball.vx;
        ball.y += ball.vy;

        // Defesa
        if(
            ball.y - ball.radius <= goalkeeper.y + goalkeeper.height &&
            ball.x >= goalkeeper.x &&
            ball.x <= goalkeeper.x + goalkeeper.width
        ){
            attempts++;
            alert("DEFENDEU!");
            resetBall();
        }

        // Gol
        if(ball.y <= 50){
            score++;
            attempts++;
            alert("GOOOL!");
            resetBall();
        }
    }

    // ===== PULO DO GOLEIRO =====
    if(goalkeeper.jumping){
        goalkeeper.jumpProgress += 0.05;

        // Movimento lateral
        goalkeeper.x = goalkeeper.baseX + 
                       goalkeeper.targetSide * 150 * goalkeeper.jumpProgress;

        // Movimento vertical em arco
        goalkeeper.y = 90 - 
                       Math.sin(goalkeeper.jumpProgress * Math.PI) * 80;

        if(goalkeeper.jumpProgress >= 1){
            goalkeeper.jumping = false;
            goalkeeper.x = goalkeeper.baseX;
            goalkeeper.y = 90;
        }
    }
}

function resetBall(){
    ball.x = 400;
    ball.y = 420;
    ball.moving = false;
}

function gameLoop(){
    drawField();
    drawBall();
    drawGoalkeeper();
    drawScore();
    update();
    requestAnimationFrame(gameLoop);
}

gameLoop();
</script>

</body>
</html>
